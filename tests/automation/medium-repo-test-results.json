[
  {
    "name": "Express Middleware Functions",
    "repo": "express",
    "type": "nested-function",
    "mcp": {
      "executionTime": 60,
      "matchCount": 214,
      "truncated": true,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\benchmarks\\middleware.js",
          "line": 11,
          "text": "function(req, res, next){\r\n    next();\r\n  }"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\examples\\web-service\\index.js",
          "line": 30,
          "text": "function(req, res, next){\r\n  var key = req.query['api-key'];\r\n\r\n  // key isn't present\r\n  if (!key) "
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\examples\\web-service\\index.js",
          "line": 85,
          "text": "function(req, res, next){\r\n  var name = req.params.name;\r\n  var user = userRepos[name];\r\n\r\n  if (use"
        }
      ]
    },
    "cli": {
      "executionTime": 56,
      "matchCount": 214,
      "samples": [
        {
          "file": "benchmarks\\middleware.js",
          "line": 11,
          "text": "function(req, res, next){\r\n    next();\r\n  }"
        },
        {
          "file": "test\\app.options.js",
          "line": 40,
          "text": "function(req, res, next){\r\n      res.setHeader('x-hit', '1');\r\n      next();\r\n    }"
        },
        {
          "file": "test\\app.options.js",
          "line": 83,
          "text": "function (req, res, next) {\r\n        res.writeHead(200);\r\n        next();\r\n      }"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "CLI faster by 4ms",
      "matchDifference": 0,
      "timeDifference": 4
    }
  },
  {
    "name": "Express Callback Patterns",
    "repo": "express",
    "type": "simple-pattern",
    "mcp": {
      "executionTime": 68,
      "matchCount": 907,
      "truncated": true,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\benchmarks\\middleware.js",
          "line": 11,
          "text": "function(req, res, next){\r\n    next();\r\n  }"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\benchmarks\\middleware.js",
          "line": 16,
          "text": "function(req, res){\r\n  res.send('Hello World')\r\n}"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\examples\\downloads\\index.js",
          "line": 15,
          "text": "function(req, res){\r\n  res.send('<ul>' +\r\n    '<li>Download <a href=\"/files/notes/groceries.txt\">not"
        }
      ]
    },
    "cli": {
      "executionTime": 81,
      "matchCount": 907,
      "samples": [
        {
          "file": "test\\app.all.js",
          "line": 12,
          "text": "function(req, res){\r\n      res.end(req.method);\r\n    }"
        },
        {
          "file": "test\\app.all.js",
          "line": 29,
          "text": "function(req, res, next){\r\n      if (n++) return done(new Error('DELETE called several times'));\r\n  "
        },
        {
          "file": "test\\app.head.js",
          "line": 11,
          "text": "function(req, res){\r\n      // send() detects HEAD\r\n      res.send('tobi');\r\n    }"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "MCP faster by 13ms",
      "matchDifference": 0,
      "timeDifference": -13
    }
  },
  {
    "name": "Express Route Definitions",
    "repo": "express",
    "type": "simple-pattern",
    "mcp": {
      "executionTime": 64,
      "matchCount": 414,
      "truncated": true,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.head.js",
          "line": 11,
          "text": "app.get('/tobi', function(req, res){\r\n      // send() detects HEAD\r\n      res.send('tobi');\r\n    })"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.head.js",
          "line": 24,
          "text": "app.get('/tobi', function(req, res){\r\n      // send() detects HEAD\r\n      res.send('tobi');\r\n    })"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.head.js",
          "line": 51,
          "text": "app.head('/tobi', function(req, res){\r\n      res.header('x-method', 'head')\r\n      res.end()\r\n    })"
        }
      ]
    },
    "cli": {
      "executionTime": 62,
      "matchCount": 414,
      "samples": [
        {
          "file": "examples\\cookie-sessions\\index.js",
          "line": 16,
          "text": "app.get('/', function (req, res) {\r\n  req.session.count = (req.session.count || 0) + 1\r\n  res.send('"
        },
        {
          "file": "examples\\hello-world\\index.js",
          "line": 7,
          "text": "app.get('/', function(req, res){\r\n  res.send('Hello World');\r\n})"
        },
        {
          "file": "examples\\error\\index.js",
          "line": 29,
          "text": "app.get('/', function () {\r\n  // Caught and passed down to the errorHandler middleware\r\n  throw new "
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "CLI faster by 2ms",
      "matchDifference": 0,
      "timeDifference": 2
    }
  },
  {
    "name": "Express Require Statements",
    "repo": "express",
    "type": "simple-pattern",
    "mcp": {
      "executionTime": 60,
      "matchCount": 403,
      "truncated": true,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\benchmarks\\middleware.js",
          "line": 2,
          "text": "require('..')"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.listen.js",
          "line": 3,
          "text": "require('../')"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.listen.js",
          "line": 4,
          "text": "require('node:assert')"
        }
      ]
    },
    "cli": {
      "executionTime": 59,
      "matchCount": 403,
      "samples": [
        {
          "file": "test\\app.locals.js",
          "line": 3,
          "text": "require('node:assert')"
        },
        {
          "file": "test\\app.locals.js",
          "line": 4,
          "text": "require('../')"
        },
        {
          "file": "test\\req.acceptsCharsets.js",
          "line": 3,
          "text": "require('../')"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "CLI faster by 1ms",
      "matchDifference": 0,
      "timeDifference": 1
    }
  },
  {
    "name": "Express Var to Const",
    "repo": "express",
    "type": "replacement",
    "mcp": {
      "executionTime": 125,
      "changeCount": 1713,
      "filesModified": 137,
      "skippedLines": 6687,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.head.js",
          "matches": 7
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.locals.js",
          "matches": 4
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\\test\\app.engine.js",
          "matches": 8
        }
      ]
    },
    "cli": {
      "executionTime": 68,
      "changeCount": 1713,
      "filesModified": 137,
      "diffPreview": "test\\regression.js\n@@ -0,11 +0,11 @@\n1  1 │ 'use strict'\r\n2  2 │ \r\n3    │-var express = require('../')\r\n   3 │+const express = require('../')\r\n4  4 │   , request = require('supertest');\r\n5  5 │ \r\n6  6 │ describe('throw after .end()', function(){\r\n7  7 │   it('should fail gracefully', function(done){\r\n8    │-    var app = express();\r\n   8 │+    const app = express();\r\n9  9 │ \r\n10 10│     app.get('/', function(req, res){\r\n11 11│       res.end('yay');\r\nbenchmarks\\middleware.js\n@@ -0,10 +0,10 @@\n1  "
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "CLI faster by 57ms",
      "matchDifference": 0,
      "timeDifference": 57
    }
  },
  {
    "name": "Express Console.log Detection",
    "repo": "express",
    "type": "constraint-rule",
    "mcp": {},
    "cli": {},
    "comparison": {},
    "error": "ast-grep execution failed: Command failed: cmd.exe /c C:\\Users\\nalon\\AppData\\Roaming\\npm\\ast-grep.cmd scan --rule C:\\Users\\nalon\\AppData\\Local\\Temp\\rule-1762232910983-lu7ludbgep.yml --json=stream D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\express\nError: Cannot parse rule C:\\Users\\nalon\\AppData\\Local\\Temp\\rule-1762232910983-lu7ludbgep.yml\nHelp: The file is not a valid ast-grep rule. Please refer to doc and fix the error.\nSee also: https://ast-grep.github.io/guide/rule-config.html\n\n✖ Caused by\n╰▻ Fail to parse yaml as RuleConfig\n╰▻ unknown field `constraints`, expected one of `pattern`, `kind`, `regex`, `nthChild`, `range`, `inside`, `has`, `precedes`, `follows`, `all`, `any`, `not`, `matches`\n\n"
  },
  {
    "name": "Flask Route Decorators",
    "repo": "flask",
    "type": "decorator-pattern",
    "mcp": {
      "executionTime": 62,
      "matchCount": 206,
      "truncated": true,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\type_check\\typing_route.py",
          "line": 16,
          "text": "@app.route(\"/str\")"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\type_check\\typing_route.py",
          "line": 21,
          "text": "@app.route(\"/bytes\")"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\type_check\\typing_route.py",
          "line": 26,
          "text": "@app.route(\"/json\")"
        }
      ]
    },
    "cli": {
      "executionTime": 57,
      "matchCount": 206,
      "samples": [
        {
          "file": "tests\\test_converters.py",
          "line": 19,
          "text": "@app.route(\"/<list:args>\")"
        },
        {
          "file": "tests\\type_check\\typing_route.py",
          "line": 16,
          "text": "@app.route(\"/str\")"
        },
        {
          "file": "tests\\type_check\\typing_route.py",
          "line": 21,
          "text": "@app.route(\"/bytes\")"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "CLI faster by 5ms",
      "matchDifference": 0,
      "timeDifference": 5
    }
  },
  {
    "name": "Flask Class Definitions",
    "repo": "flask",
    "type": "simple-pattern",
    "mcp": {
      "executionTime": 65,
      "matchCount": 104,
      "truncated": false,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\test_subclassing.py",
          "line": 7,
          "text": "class SuppressedFlask(flask.Flask):\r\n        def log_exception(self, exc_info):\r\n            pass"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\test_session_interface.py",
          "line": 12,
          "text": "class MySessionInterface(SessionInterface):\r\n        def save_session(self, app, session, response):"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\test_regression.py",
          "line": 5,
          "text": "class Foo(Exception):\r\n        whatever = 42"
        }
      ]
    },
    "cli": {
      "executionTime": 68,
      "matchCount": 104,
      "samples": [
        {
          "file": "tests\\type_check\\typing_route.py",
          "line": 41,
          "text": "class StatusJSON(t.TypedDict):\r\n    status: str"
        },
        {
          "file": "tests\\type_check\\typing_route.py",
          "line": 101,
          "text": "class RenderTemplateView(View):\r\n    def __init__(self: RenderTemplateView, template_name: str) -> N"
        },
        {
          "file": "tests\\test_async.py",
          "line": 14,
          "text": "class AppError(Exception):\r\n    pass"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "MCP faster by 3ms",
      "matchDifference": 0,
      "timeDifference": -3
    }
  },
  {
    "name": "Flask Import Statements",
    "repo": "flask",
    "type": "simple-pattern",
    "mcp": {
      "executionTime": 58,
      "matchCount": 473,
      "truncated": true,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\examples\\tutorial\\tests\\test_factory.py",
          "line": 1,
          "text": "from flaskr import create_app"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\type_check\\typing_route.py",
          "line": 4,
          "text": "from http import HTTPStatus"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\flask\\tests\\type_check\\typing_route.py",
          "line": 6,
          "text": "from flask import Flask"
        }
      ]
    },
    "cli": {
      "executionTime": 66,
      "matchCount": 473,
      "samples": [
        {
          "file": "tests\\test_subclassing.py",
          "line": 1,
          "text": "from io import StringIO"
        },
        {
          "file": "tests\\test_session_interface.py",
          "line": 2,
          "text": "from flask.globals import app_ctx"
        },
        {
          "file": "tests\\test_session_interface.py",
          "line": 3,
          "text": "from flask.sessions import SessionInterface"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "MCP faster by 8ms",
      "matchDifference": 0,
      "timeDifference": -8
    }
  },
  {
    "name": "Fastify Plugin Registration",
    "repo": "fastify",
    "type": "simple-pattern",
    "mcp": {
      "executionTime": 121,
      "matchCount": 104,
      "truncated": false,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\examples\\use-plugin.js",
          "line": 19,
          "text": "fastify.register(require('./plugin'), opts, function (err) {\n  if (err) {\n    throw err\n  }\n})"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\test\\esm\\esm.test.mjs",
          "line": 7,
          "text": "fastify.register(import('./plugin.mjs'), { foo: 'bar' })"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\examples\\route-prefix.js",
          "line": 18,
          "text": "fastify.register(function (instance, options, done) {\n  // the route will be '/english/hello'\n  inst"
        }
      ]
    },
    "cli": {
      "executionTime": 127,
      "matchCount": 104,
      "samples": [
        {
          "file": "examples\\use-plugin.js",
          "line": 19,
          "text": "fastify.register(require('./plugin'), opts, function (err) {\n  if (err) {\n    throw err\n  }\n})"
        },
        {
          "file": "examples\\route-prefix.js",
          "line": 18,
          "text": "fastify.register(function (instance, options, done) {\n  // the route will be '/english/hello'\n  inst"
        },
        {
          "file": "examples\\route-prefix.js",
          "line": 26,
          "text": "fastify.register(function (instance, options, done) {\n  // the route will be '/italian/hello'\n  inst"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "MCP faster by 6ms",
      "matchDifference": 0,
      "timeDifference": -6
    }
  },
  {
    "name": "Fastify Route Handlers",
    "repo": "fastify",
    "type": "simple-pattern",
    "mcp": {
      "executionTime": 156,
      "matchCount": 2260,
      "truncated": true,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\examples\\use-plugin.js",
          "line": 19,
          "text": "fastify.register(require('./plugin'), opts, function (err) {\n  if (err) {\n    throw err\n  }\n})"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\examples\\use-plugin.js",
          "line": 25,
          "text": "fastify.listen({ port: 3000 }, function (err) {\n  if (err) {\n    throw err\n  }\n})"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\integration\\server.js",
          "line": 12,
          "text": "fastify.get('/', async function (request, reply) {\n  reply.code(200).send({ data: 'home page' })\n})"
        }
      ]
    },
    "cli": {
      "executionTime": 151,
      "matchCount": 2260,
      "samples": [
        {
          "file": "examples\\use-plugin.js",
          "line": 19,
          "text": "fastify.register(require('./plugin'), opts, function (err) {\n  if (err) {\n    throw err\n  }\n})"
        },
        {
          "file": "examples\\use-plugin.js",
          "line": 25,
          "text": "fastify.listen({ port: 3000 }, function (err) {\n  if (err) {\n    throw err\n  }\n})"
        },
        {
          "file": "examples\\simple.js",
          "line": 22,
          "text": "fastify\n  .get('/', schema, function (req, reply) {\n    reply\n      .send({ hello: 'world' })\n  })"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "CLI faster by 5ms",
      "matchDifference": 0,
      "timeDifference": 5
    }
  },
  {
    "name": "Fastify Async Functions",
    "repo": "fastify",
    "type": "async-pattern",
    "mcp": {
      "executionTime": 114,
      "matchCount": 22,
      "truncated": false,
      "skippedLines": 0,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\test\\close.test.js",
          "line": 653,
          "text": "async function onClose () {\n    t.assert.strictEqual(preCloseCalled, true)\n  }"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\test\\close.test.js",
          "line": 658,
          "text": "async function preClose () {\n    preCloseCalled = true\n    t.assert.ok(typeof this === typeof fastif"
        },
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\test\\https\\custom-https-server.test.js",
          "line": 10,
          "text": "async function setup () {\n  await buildCertificate()\n\n  const localAddresses = await dns.lookup('loc"
        }
      ]
    },
    "cli": {
      "executionTime": 137,
      "matchCount": 22,
      "samples": [
        {
          "file": "examples\\benchmark\\hooks-benchmark-async-await.js",
          "line": 24,
          "text": "async function asyncHook () {\n  await new Promise(promiseFunction)\n}"
        },
        {
          "file": "test\\esm\\plugin.mjs",
          "line": 2,
          "text": "async function plugin (fastify, opts) {\n  fastify.decorate('foo', opts.foo)\n}"
        },
        {
          "file": "test\\custom-http-server.test.js",
          "line": 9,
          "text": "async function setup () {\n  const localAddresses = await dns.lookup('localhost', { all: true })\n\n  t"
        }
      ]
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "MCP faster by 23ms",
      "matchDifference": 0,
      "timeDifference": -23
    }
  },
  {
    "name": "Fastify Var to Const",
    "repo": "fastify",
    "type": "replacement",
    "mcp": {
      "executionTime": 95,
      "changeCount": 45,
      "filesModified": 1,
      "skippedLines": 250,
      "samples": [
        {
          "file": "D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\\lib\\config-validator.js",
          "matches": 45
        }
      ]
    },
    "cli": {
      "executionTime": 114,
      "changeCount": 45,
      "filesModified": 1,
      "diffPreview": "lib\\config-validator.js\n@@ -97,7 +97,7 @@\n98  98 │ }\n99  99 │ }\n100 100│ }\n101    │-var valid0 = _errs2 === errors;\n    101│+const valid0 = _errs2 === errors;\n102 102│ if(valid0){\n103 103│ let data1 = data.keepAliveTimeout;\n104 104│ const _errs4 = errors;\n@@ -121,7 +121,7 @@\n122 122│ }\n123 123│ }\n124 124│ }\n125    │-var valid0 = _errs4 === errors;\n    125│+const valid0 = _errs4 === errors;\n126 126│ if(valid0){\n127 127│ if(data.forceCloseConnections !== undefined){\n128 128│ let data2 = data.force"
    },
    "comparison": {
      "accuracy": "Identical",
      "performance": "MCP faster by 19ms",
      "matchDifference": 0,
      "timeDifference": -19
    }
  },
  {
    "name": "Fastify Deprecated API Detection",
    "repo": "fastify",
    "type": "constraint-rule",
    "mcp": {},
    "cli": {},
    "comparison": {},
    "error": "ast-grep execution failed: Command failed: cmd.exe /c C:\\Users\\nalon\\AppData\\Roaming\\npm\\ast-grep.cmd scan --rule C:\\Users\\nalon\\AppData\\Local\\Temp\\rule-1762232912416-fokue48g2bl.yml --json=stream D:\\_Project\\_mcp\\tree-grep-mcp\\test-repos\\fastify\nError: Cannot parse rule C:\\Users\\nalon\\AppData\\Local\\Temp\\rule-1762232912416-fokue48g2bl.yml\nHelp: The file is not a valid ast-grep rule. Please refer to doc and fix the error.\nSee also: https://ast-grep.github.io/guide/rule-config.html\n\n✖ Caused by\n╰▻ Fail to parse yaml as RuleConfig\n╰▻ unknown field `constraints`, expected one of `pattern`, `kind`, `regex`, `nthChild`, `range`, `inside`, `has`, `precedes`, `follows`, `all`, `any`, `not`, `matches`\n\n"
  }
]